<!DOCTYPE html>
<html lang="en">

	<head>
		<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
		<title>微位科技 | 名片模版管理</title>
		<meta http-equiv="X-UA-Compatible" content="IE=edge">
		<meta content="width=device-width, initial-scale=1" name="viewport">
		<meta name="viewport" content="width=1280">
		<meta content="" name="description">
		<meta content="" name="author">
		<link rel="stylesheet" type="text/css" href="css/layout.min.css" />
		<link rel="stylesheet" type="text/css" href="css/darkblue.min.css" />
		<link rel="stylesheet" type="text/css" href="css/reset.css" />
		<link rel="stylesheet" type="text/css" href="css/font-awesome.min.css" />
		<link rel="stylesheet" type="text/css" href="css/index.css"/>
		<link rel="stylesheet" type="text/css" href="css/edit.css"/>
		<script src="js/jquery.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/app.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/layout.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/bootstrap.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/bootstrap-hover-dropdown.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/jquery.slimscroll.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/jquery.blockui.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/bootstrap-switch.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/metronic.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/jstree.min.js" type="text/javascript"></script>
		<script src="js/moment-with-locales.min.js" type="text/javascript"></script>
		<script src="js/bootstrap-datetimepicker.min.js"></script>
		<script src="js/bootstrap-datetimepicker.zh-CN.js"></script>
		<script src="js/bootbox.min.js" type="text/javascript"></script>
		<script src="js/pageInfo.js"></script>
		<script src="js/bootstrap-modal.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/demo.min.js" type="text/javascript"></script>
		<script src="js/quick-sidebar.min.js" type="text/javascript"></script>
		<script src="js/layer.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/clipboard.min.js" type="text/javascript" charset="utf-8"></script>

	</head>

	<body class="page-header-fixed page-sidebar-closed-hide-logo page-content-white">
		<div class="page-header navbar navbar-fixed-top">
			<div class="page-header-inner ">
				<div class="page-logo">
					<a    style="height:100%;">
						<img src="img/sidebar_toggler_icon_darkblue.png" alt="logo" class="logo-default">微位科技 </a>

					<div class="menu-toggler sidebar-toggler"></div>
				</div>
				<a href="javascript:;" class="menu-toggler responsive-toggler" data-toggle="collapse" data-target=".navbar-collapse"> </a>

				<div class="top-menu">
					<ul class="nav navbar-nav pull-right">

						<li class="dropdown dropdown-user">
							<a href="javascript:;" class="dropdown-toggle" data-toggle="dropdown" data-hover="dropdown" data-close-others="true">
								<span class="username username-hide-on-mobile"> 微位科技</span>
								<i class="fa fa-angle-down"></i>
							</a>
							<ul class="dropdown-menu dropdown-menu-default">
								
								<li class="logout">
									<a>注销 </a>
								</li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
		</div>

		<div class="clearfix"></div>
		<div class="page-container">
			<div class="page-sidebar-wrapper">
				<div class="page-sidebar navbar-collapse collapse">

					<ul class="page-sidebar-menu  page-header-fixed " data-keep-expanded="false" data-auto-scroll="true" data-slide-speed="200" style="padding-top: 20px" id="sidebarNav">
						
						<li class="nav-item">
							<a href="manage_cards.html" class="nav-link">
								<i class="icon-home"></i>
								<span class="title">首页</span>
							</a>
						</li>
						
						
						<li class="nav-item  start active open">
							<a href="javascript:;" class="nav-link nav-toggle">
								<i class="icon-briefcase"></i>
								<span class="title">智能名片</span>
								<span class="arrow open"></span>
							</a>
							<ul class="sub-menu">
								<li class="nav-item">
									<a href="manage_cards.html">
										<span class="title nav-link">模版管理</span>
									</a>
								</li>
								<li class="nav-item open active">
									<a href="choose.html">
									  <span class="title nav-link">新增模版</span>
									</a>
								</li>

								<li class="nav-item  ">
									<a href="account_management.html">
										<span class="title ">帐号管理</span>
									</a>
								</li>
							</ul>
						</li>
					</ul>
				</div>
			</div>
			<div class="page-content-wrapper">
				<div class="page-content" >
					<h3 class="page-title">××公司名片样式模版</h3>
					<div class="wrap_table">
						<div class="portlet-title margin-bottom-40">
							<a class="btn btn-circle green characters">添加文字</a>
							<a class="btn btn-circle green reset pic">添加图片</a>
							<select  class="textAlign">
								<option value="">对齐</option>
								<option value="left">左对齐</option>
								<option value="right">右对齐</option>
								<option value="center">水平居中</option>
								<option value="top">顶部对齐</option>
								<option value="botttom">底部对齐</option>
								<option value="center">均分高度</option>
								<option value="center">均分宽度</option>
							</select>
							<a class="btn btn-circle green btn-outline back_color">
								<input name="back_color" type="text"/>
								背景色
							</a>
							<a class="btn btn-circle green btn-outline back">撤回</a>
							<a class="btn btn-circle green btn-outline del">删除</a>
							<a class="btn btn-circle green btn-outline label">不可变内容</a>
							<a class="btn btn-circle green btn-outline field">可变内容</a>
						</div>
						
						
						<div class="wrap_card">
						<span class="active guide_cards guide_positive">
							名片正面
						</span>
						
						<span class="guide_cards guide_back">
							名片反面
						</span>
						
						<div class="line_one line"></div>
						<div class="line_two line"></div>
						
						<div class="card card_positive">
					
				        </div>
				        
				        <div class="card card_back" style="display: none;">
					
				        </div>
				        
					</div>
					
					<div class="wrap_edits">
						<div class="edit_characters">
							<h1>添加文字</h1>
							<div class="portlet-title three clearfix">
								<div class="content">
									<label>字段名称 </label>
									<!--<select class="type">
										<option value="name">姓名</option>
										<option value="mobile">电话</option>
										<option value="job">职位</option>
										<option value="wechat">微信</option>
										<option value="qq">QQ</option>
										<option value="email">邮箱</option>
										<option value="dept">部门</option>
										<option value="company">公司名</option>
										<option value="website">网址</option>
										<option value="weibo">微博</option>
									</select>-->
									
									  <select class="type"  id="field">
                                      <option v-cloak   v-bind:value=item.class  v-for="item in field" v-bind:data-id=item.id   v-bind:data-order=item.order  v-bind:data-type=item.type>{{item.name}}</option>
                                      </select>
                                </div>
								
								<div class="content">
									<label>字段类型</label>
									<input type="text" name="" id="" value="" class="field_type" disabled="disabled"/>
									
								</div>
								
								<div class="content">
									<label>字段排序</label>
									<input type="text" name="" id="" value="" class="field_order" disabled="disabled"/>
								</div>
							</div>
							
							
							<div class="portlet-title two clearfix">
								<div class="content">
									<div class="icon">
										上传图标
										<span >＋</span>
									</div>
									<input type="file" hidden="hidden" name="" class="icon_upload" value="" />
								</div>
								
								<div class="content">
									<label>设置层级</label>
									<input type="text" name=""  value="" class="zIndex"/>
								</div>
							</div>
							
							
							<div class="portlet-title one clearfix">
								<input type="text" name="" class="contents" value="" placeholder="请输入内容"/>
							</div>
							
						</div>
						
						<div class="edit_characters">
							<div class="portlet-title two clearfix">
								<div class="content">
									<label>选择字体</label>
									<select class="ftFamily">
										<option value="微软雅黑" >微软雅黑</option>
										<option value="arial">arial</option>
										
									</select>
								</div>
								
								<div class="content">
									<label>字体大小</label>
									<!--<select >
										<option value="">10</option>
										<option value="">9</option>
									</select>-->
									<input type="text" name="" id="" value="" class="ftsize" />
								</div>
							</div>
							
							<div class="portlet-title two clearfix">
								<div class="content">
									<label>字体颜色</label>
									<!--<select >
										<option value=""></option>
										<option value=""></option>
										
									</select>-->
									<input type="text" name="" id="" value="" class="color" />
								</div>
								
								<div class="content">
									<label>字体方向</label>
									<select class="writingModel">
										<option value="horizontal-tb">横向</option>
										<option value="vertical-rl">竖向</option>
									</select>
								</div>
							</div>
							
							<div class="portlet-title clearfix">
								<label>字体格式</label>
								<label> <input type="radio" name="font" id="font" value="ftweight" />加粗</label>
								<label> <input type="radio" name="font" id="font" value="ftstyle" />斜体</label>
								<label> <input type="radio" name="font" id="font" value="regular" />常规</label>
							</div>
							
							<div class="portlet-title two clearfix">
								<div class="content">
									<label>宽　　度</label>
									<input type="text" name="" id="" value="" class="width" />
								</div>
								
								<div class="content">
									<label>高　　度</label>
									<input type="text" name="" id="" value="" class="height" />
								</div>
							</div>
							<p class="tips">tips:宽度和高度按照父类的百分比显示！</p>
					    </div>
					
					    <div class="edit_pic" style="display: none;">
					    	<h1>添加图片</h1>
					    	<div class="content">
					    		<div class="portlet-title clearfix">
								<div class="content">
									<label>图片类型</label>
									<select class="img_type">
										<option value="0">二维码</option>
										<option value="1">小图标</option>
										<option value="2">背景图</option>
									</select>
								</div>
								
								<div class="button pic_local">
									复制本地图片
								</div>
								<input type="file" hidden="hidden" name=""  class="add_pic_ipt" value="" />
								<div class="button add_pic_buttom">
									上传图片
								</div>
								
								<div class="content">
									<label>叠放层次</label>
									<select>
										<option value="">置顶</option>
										<option value="">置底</option>
										<option value="">置中</option>
									</select>
								</div>
							</div>
					    	</div>
					    </div> 
					   
					</div>
					</div>
					
					
					<div class="guide">
						<button type="submit" class="btn green pre_step">上一步</button>
						<button type="submit" class="btn green preview">预览</button>
						<button type="submit" class="btn green save">提交</button>
					</div>
					
					
				</div>
			</div>
		</div>
		<div class="page-footer">
			<div class="page-footer-inner"> 2015 © 微位科技

			</div>
			<div class="scroll-to-top">
				<i class="icon-arrow-up"></i>
			</div>
		</div>
		<script src="js/variable.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/vue.min.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/drag.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/index.js" type="text/javascript" charset="utf-8"></script>
		<script src="js/common1.js" type="text/javascript" charset="utf-8"></script>
		<script type="text/javascript">
		/*切换添加文字，添加图片*/
		/*$(".btn").click(function(){
			if($(this).hasClass("pic")){
				$(".pic").removeClass("reset");
				$(".characters").addClass("reset");
				$(".edit_characters").css("display","none");
				$(".edit_pic").css("display","block");
				
			}else if($(this).hasClass("characters")){
				$(".pic").addClass("reset");
				$(".characters").removeClass("reset");
				$(".edit_characters").css("display","block");
				$(".edit_pic").css("display","none");
			}
		})*/
		function getQueryString(name) { 
			var reg = new RegExp("(^|&)" + name + "=([^&]*)(&|$)", "i"); 
			var r = window.location.search.substr(1).match(reg); 
			if (r != null) return unescape(r[2]); return null; 
		} 
		    
		var id = getQueryString("id");
		var type = getQueryString("type");
		
		  /*获取字段类型*/
		  function getField(companyId){
		  	  $.ajax({
					/*type:"POST",
					url:url+"cardTemplate/findFieldInfos",*/
					type:"get",
					url:"json/fields.json",
					async:true,
					data:{companyId:companyId}, 
					crossDomain:true,
					xhrFields: {  withCredentials: true  },
					success:function(data){
						if(data.code=="0001"){
								if(data.result[1]){
							   var result = data.result[0].concat(data.result[1]);
							}else{
							   var result = data.result[0];
							}
							result.push({name:"手机",class:"cardMobile",type:"mobile"});
							result.push({name:"姓名",class:"cardUserName",type:"userName"});
							$(result).each(function(i,item){ 
								if(item.name == "姓名"){
									item.class = "cardUserName";
								}else if(item.name == "电话"){
									item.class = "cardMobile";
								}else if(item.name == "职位"){
									item.class = "job";
								}else if(item.name == "微信"){
									item.class = "wechat";
								}else if(item.name == "QQ"){
									item.class = "qq";
								}else if(item.name == "邮箱"){
									item.class = "email";
								}else if(item.name == "部门"){
									item.class = "dept";
								}else if(item.name == "公司"){
									item.class = "company";
								}else if(item.name == "网址"){
									item.class = "website";
								}else if(item.name == "微博"){
									item.class = "weibo";
								}else if(item.name == "地址"){
									item.class = "address";
								}else if(item.name == "传真"){
									item.class = "fax";
								}else if(item.name == "邮编"){
									item.class = "postcode";
								}
							});
							 appFiled = new Vue({
								  el: '#field',
								  data: {
								    field: result
								  }
								});
							
						}else if(data.code =="1001"){
						window.location.href = "login.html"
						}
						
					},
				    error:function(e){
				    	console.log(e)
				    }
			});
		  }
		/*获取字段名称*/
		  $("body").on("change","#field",function(e){
	     	var order =  $("#field :selected").data("order");
	     	var type =  $("#field :selected").data("type");
	     	$(".field_type").val(type);
	     	$(".field_order").val(order);
	     	
	     	})		
		/*通过id查询名片模板*/
		if(type == "edit"){
			$.ajax({
					type:"get",
					url:url+"cardTemplate/findCardTemplate",
					async:true,
					crossDomain:true,
					xhrFields: {  withCredentials: true  },
					data:{id:getQueryString("id")},
					success:function(data){
						if(data.code == "0001"){
							var result = data.result;
							 message = {name:result.name,
							           companyId:result.companyId,
							           companyName:result.companyName,
							           positiveContent:result.positiveContent,
							           backContent:result.backContent,
							           templateType:result.templateType,
							           creatorId:result.creatorId,
							           imgUrl:""
							 }
							 
							$(".card_positive").replaceWith(message.positiveContent);
			                $(".card_back").replaceWith(message.backContent);
			                $(".card_back").css("display","none");
			                $(".card").css("visibility","visible");
						}else if(data.code =="1001"){
							window.location.href = "login.html"
						}
						
						getField(message.companyId);
						/*$(".card_positive").replaceWith(message.templateContent.positive);
			            $(".card_back").replaceWith(message.templateContent.back);*/
						 
					},
				    error:function(e){
				    	console.log(e)
				    }
			});
		}else if(type == "add"){
			var companyId = getQueryString("companyId");
			var name = getQueryString("name");
			$.ajax({
					type:"get",
					url:url+"cardTemplate/findCardTemplate",
					async:true,
					crossDomain:true,
					xhrFields: {  withCredentials: true  },
					data:{id:getQueryString("companyId")},
					success:function(data){
						if(data.code == "0001"){
							var result = data.result;
							if(result){
								message = {name:decodeURI(escape(name)),
							           companyId:id,
							           companyName:decodeURI(escape(name)),
							           positiveContent:result.positiveContent,
								       backContent:result.backContent,
							           templateType:result.templateType,
							           creatorId:result.creatorId,
							           imgUrl:""

							    }
								$(".card_positive").replaceWith(message.positiveContent);
				                $(".card_back").replaceWith(message.backContent);
				                $(".card_back").css("display","none");
				                $(".card").css("visibility","visible");
							    getField(message.companyId);
								
							}else{
								message = {name:"",
								           companyId:"",
								           companyName:"",
								           positiveContent:"",
									       backContent:"",
								           templateType:"",
								           creatorId:"",
								           imgUrl:""
	
								    }
							}
							 
						}else if(data.code =="1001"){
							window.location.href = "login.html"
						}
						
						/*$(".card_positive").replaceWith(message.templateContent.positive);
			            $(".card_back").replaceWith(message.templateContent.back);*/
						 
					},
				    error:function(e){
				    	console.log(e)
				    }
			});
		}
		
		if(getQueryString("id")==getQueryString("companyId")){
			getField(getQueryString("id"))
		}
		window.onload = function(){
			setTimeout(function(){
				                	$(".card  span").each(function(i,item){
				                	$(item).dragging({
										move: 'both', //拖动方向，x y both
										randomPosition: false
									});
					                })
				                },500);
		
            $("h3.page-title").html(decodeURI("\""+escape(getQueryString("name")))+"\"名片样式模版")
		}
		
		
		</script>
		</body>   
		</html>